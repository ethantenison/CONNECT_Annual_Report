---
title: "CONNECT Annual Report"
author: "Ethan Tenison"
date: "`r format(Sys.Date(), '%B %d, %Y') `"
output:
  bookdown::html_document2:
    toc: yes
    toc_float: yes
    toc_depth: 3
    collapsed: no
    number_sections: yes
    fig_caption: yes
always_allow_html: yes
editor_options:
  chunk_output_type: console
runtime: shiny
resource_files:
- references/images/RGB_formal_RGK.png
---


```{r setup, include=FALSE}
library(shiny)

library(bookdown)
library(officer)
library(officedown)

library(tm)
library(wordcloud)
library(wordcloud2)
library(NLP)

library(tidyverse)

# render tables
library(kableExtra)
library(flextable)

library(scales)
library(extrafont)
library(ggpubr)
library(hablar) # Easily change column type
library(extrafont)
library(lubridate)
library(plotly)
library(ggthemes)
library(DT)
library(htmlwidgets)
library(data.table)
library(htmlwidgets)
library(readxl)
library(igraph)

knitr::opts_chunk$set(echo = FALSE, dpi = 300)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
```

```{r htmlTemplate, echo=FALSE}
# Create the external file
htmltools::img(src = knitr::image_uri("C:/Users/tenis/Desktop/Data_Projects/CONNECT_Annual_Report/references/images/RGB_formal_RGK_resized.png"), 
               alt = 'logo', 
               style = 'position:absolute; top:50px; right:1%; padding:10px;z-index:200;')


```



```{r constants, include=FALSE}

color_hd <- "#00a9e0"  
color_font <- "#283e36"
color_bg <- "#eff2f1"
color_red <- "#e00034"
color_blue <-  "#0f4dbc"
```



```{r my_functions, include=F}



# glue is better
fn_text <- function(txt, color = color_font, size_px = 15)
  glue::glue('
             <span style="
              color:{color}; 
              font-size: {size_px}px">
              {txt}
             </span>')


```

<br>

# Introduction

The purpose of this document is to provide updates on the CONNECT Program during year 3 of it's development

# CONNECT Program Network 

Since it's inception in 2018, CONNECT has partnered with 80 unique organizations. 

```{r network_viz, include = T}


network_raw <- read_excel("data/interim/raw_network.xlsx") |> 
  distinct()

g1<-graph_from_data_frame(d=network_raw,directed=TRUE) 

#Degree in 
inDegree<-igraph::degree(g1,mode="in")
outDegree<-igraph::degree(g1,mode="out")
TotalDegree<-as.data.frame(igraph::degree(g1))
betweenness<-igraph::betweenness(g1, v = V(g1), directed = TRUE, weights = NULL,
  nobigint = TRUE, normalized = TRUE)
inCloseness<-igraph::closeness(g1, vids = V(g1), mode = c("in"),normalized = TRUE)
outCloseness<-igraph::closeness(g1, vids = V(g1), mode = c("out"),normalized = TRUE)
DF_Centrality<-as.data.frame(cbind(rownames(TotalDegree),inDegree,outDegree,TotalDegree,betweenness,inCloseness,outCloseness))


#Ploting a basic network graph with igraph dataframe 
plot(g1, edge.color = "slateblue", edge.width = E(g1)$weight, layout = layout_nicely, vertex.label = ifelse(igraph::degree(g1) > 4, V(g1)$name, NA), vertex.size = sqrt(igraph::degree(g1) * 2), vertex.label.color = "black", vertex.label.font = 2, vertex.label.degree = 1.5, vertex.label.cex = 1.3, asp = -5, vertex.color = "gold") # vertex.frame.color = "gold"
title("NPO Network", cex.main = 3)



```

